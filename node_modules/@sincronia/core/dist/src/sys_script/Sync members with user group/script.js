"use strict";

(function executeRule(cur, prev) {
  var newMemberGr = new GlideRecord('sys_user_grmember');
  newMemberGr.newRecord();
  newMemberGr.setValue('group', cur.team.getRefRecord().getValue('related_group') || '');
  newMemberGr.setValue('user', cur.getValue('member') || '');
  newMemberGr.insert();
  var oldMemberGr = new GlideRecord('sys_user_grmember');
  oldMemberGr.addQuery('group', prev.team.getRefRecord().getValue('related_group') || '');
  oldMemberGr.addQuery('user', prev.getValue('member') || '');
  oldMemberGr.query();

  if (oldMemberGr.next()) {
    FieldServiceTeamUtils.deleteTeamMemberById(oldMemberGr.getValue('sys_id') || '');
  }
})(current, previous);